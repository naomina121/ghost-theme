<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    {{!-- CSS --}}
{{#if post}}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.12.3/tocbot.css">
<style>
.gh-content {
    position: relative;
 }

.gh-toc > .toc-list {
    position: relative;
}

.toc-list {
    overflow: hidden;
    list-style: none;
    padding-left:30px;
}

@media (min-width: 1300px) {
     .gh-sidebar {
        position: absolute;
        top: 0;
        bottom: 0;
        margin-top: 4vmin;
        grid-column: wide-start / main-start; /* Place the TOC to the left of the content */
    }

    .gh-toc {
        position: sticky; /* On larger screens, TOC will stay in the same spot on the page */
        top: 4vmin;
    }
}

.gh-toc .is-active-link::before {
    background-color: var(--ghost-accent-color); /* Defines TOC   accent color based on Accent color set in Ghost Admin */
}
</style>
{{/if}}
    <link rel="icon" href="{{asset "favicon.ico"}}" type="image/x-icon" />
    <link rel="stylesheet" href="{{asset "css/reset.css"}}" />
    <link rel="stylesheet" href="{{asset "built/main.css"}}" />
    <link rel="stylesheet" href="{{asset "css/style.css"}}" />

    {{!-- タイトル --}}
    <title>{{meta_title}}</title>

    {{!-- Ghost head --}}
    {{ghost_head}}
  </head>
  <body class="{{body_class}}">
    <main>
      {{!-- ヘッダー --}}
      {{> header}}
      {{!-- メインコンテンツ --}}
      {{{body}}}
    </main>
    {{!-- フッター --}}
    {{> footer}}
    {{!-- JavaScript --}}
    <script src="{{asset 'js/main.js'}}"></script>
    {{!-- TOCBot --}}
    {{#if post}}
<script>
   const headings = document.querySelectorAll('.post-content h2, .post-content h3');

    for (let i = 0; i < headings.length; i++) {
      headings[i].id = 'heading-' + (i + 1);
    }
</script>



    <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.12.3/tocbot.min.js"></script>
    <script>
const headers = document.body.querySelectorAll('.post-content h2,.post-content h3');
const tooLong = headers.length > 40 || document.body.scrollHeight > 30000;

if (tooLong) {
  console.log('長すぎるコンテンツが検出されました。');
  tocbot.init({
    tocSelector: '.gh-toc',
    contentSelector: '.post-content',
    headingSelector: 'h2',
    scrollSmoothOffset: -60,
    headingsOffset: 60,
    throttleTimeout: 40
  }),
    tocbot.init({
    tocSelector: '.toc-list',
    contentSelector: '.post-content',
    headingSelector: 'h2, h3',
    hasInnerContainers: true,
        scrollSmoothOffset: -60, // ヘッダーの高さを考慮
        scrollSmooth: true,
        scrollSmoothDuration: 300
      });
} else {
  console.log('通常のコンテンツが検出されました。');
  tocbot.init({
    tocSelector: '.gh-toc',
    contentSelector: '.post-content',
    headingSelector: 'h2, h3',
    hasInnerContainers: true,
    scrollSmoothOffset: -60, // ヘッダーの高さを考慮
    headingsOffset: 60,
    throttleTimeout: 40,
    scrollSmooth: true,
  }),
    tocbot.init({
    tocSelector: '.toc-list',
    contentSelector: '.post-content',
    headingSelector: 'h2, h3',
    hasInnerContainers: true,
    scrollSmoothOffset: -60, // ヘッダーの高さを考慮
    scrollSmooth: true,
    scrollSmoothDuration: 300
      });
}
    </script>
    {{/if}}
    {{ghost_foot}}
  </body>
</html>